<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Flui360 - Dashboard principal de hábitos">
    <title>Flui360 - Dashboard</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body class="pagina-app">
    <!-- Skip link para acessibilidade -->
    <a href="#conteudo-principal" class="skip-link">Pular para o conteúdo principal</a>
    
    <!-- Região de anúncios para leitores de tela -->
    <div id="ariaLiveRegion" class="aria-live-region" aria-live="polite" aria-atomic="true"></div>
    
    <!-- 
        DASHBOARD (dashboard.html)
        ==========================
        Tela principal após o login.
        
        FAB GLOBAL:
        - Ao clicar no FAB, abre modal de seleção de tipo de hábito
        - Mesmo fluxo de criação usado em "Meus Hábitos"
        
        HÁBITOS DE HOJE:
        - Para binários: toggle simples
        - Para mensuráveis: abre modal de valor (consistente com Meus Hábitos)
    -->

    <div class="sidebar-backdrop" id="sidebarBackdrop"></div>

    <aside class="sidebar" id="sidebar" role="navigation" aria-label="Menu principal">
        <div class="sidebar-header">
            <div class="logo">
                <span class="logo-icone" aria-hidden="true">&#9679;</span>
                <span class="logo-texto">Flui360</span>
            </div>
        </div>
        
        <nav class="sidebar-nav" aria-label="Navegação principal">
            <ul>
                <li>
                    <a href="dashboard.html" class="nav-link nav-link-ativo" aria-current="page">
                        <span class="nav-icone">&#9632;</span>
                        Dashboard
                    </a>
                </li>
                <li>
                    <a href="habitos.html" class="nav-link">
                        <span class="nav-icone">&#10003;</span>
                        Meus Hábitos
                    </a>
                </li>
                <li>
                    <a href="relatorios.html" class="nav-link">
                        <span class="nav-icone">&#9776;</span>
                        Relatórios
                    </a>
                </li>
            </ul>
        </nav>

        <div class="sidebar-footer">
            <button type="button" class="nav-link nav-link-preferencias" id="btnAbrirPreferencias">
                <span class="nav-icone">&#9881;</span>
                Preferências
            </button>
            <a href="index.html" class="nav-link nav-sair">
                <span class="nav-icone">&#8592;</span>
                Sair
            </a>
        </div>
    </aside>

    <div class="conteudo-principal" id="conteudo-principal" role="main">
        <header class="header-app">
            <button class="btn-hamburguer" id="btnHamburguer" aria-label="Abrir menu" aria-expanded="false">
                <span class="hamburguer-linha"></span>
                <span class="hamburguer-linha"></span>
                <span class="hamburguer-linha"></span>
            </button>
            
            <div class="header-usuario">
                <span class="saudacao">Olá, <strong>Usuário</strong>!</span>
            </div>
        </header>

        <main class="main-content">
            <h1 class="titulo-pagina">Dashboard</h1>
            
            <div class="boas-vindas-box" id="boasVindasBox">
                <p class="boas-vindas-texto">
                    <strong>Bem-vindo ao Flui360!</strong> Você está vendo alguns hábitos de exemplo 
                    para conhecer o app. Use o botão <span class="destaque-fab">+</span> no canto 
                    inferior direito para criar seus próprios hábitos, ou edite os existentes 
                    em <a href="habitos.html">Meus Hábitos</a>.
                </p>
                <button type="button" class="btn-fechar-boas-vindas" id="btnFecharBoasVindas" aria-label="Fechar mensagem">&times;</button>
            </div>
            
            <section class="resumo-cards">
                <article class="card-resumo">
                    <div class="card-resumo-icone cor-primaria">&#10003;</div>
                    <div class="card-resumo-info">
                        <span class="card-resumo-valor" id="habitosAtivos">5</span>
                        <span class="card-resumo-label">Hábitos Ativos</span>
                    </div>
                </article>

                <article class="card-resumo">
                    <div class="card-resumo-icone cor-sucesso">&#9733;</div>
                    <div class="card-resumo-info">
                        <span class="card-resumo-valor" id="sequenciaAtual">7</span>
                        <span class="card-resumo-label">
                            Dias de Sequência
                            <button type="button" class="info-icone" aria-label="O que são dias de sequência" aria-expanded="false">
                                &#9432;
                                <span class="info-icone-tooltip">Maior sequência atual de dias consecutivos concluindo um hábito.</span>
                            </button>
                        </span>
                    </div>
                </article>

                <article class="card-resumo">
                    <div class="card-resumo-icone cor-aviso">&#9679;</div>
                    <div class="card-resumo-info">
                        <span class="card-resumo-valor" id="completadosHoje">3</span>
                        <span class="card-resumo-label">Completados Hoje</span>
                    </div>
                </article>

                <article class="card-resumo">
                    <div class="card-resumo-icone cor-info">&#37;</div>
                    <div class="card-resumo-info">
                        <span class="card-resumo-valor" id="taxaConclusao">78%</span>
                        <span class="card-resumo-label">
                            Taxa de Conclusão
                            <button type="button" class="info-icone" aria-label="O que é taxa de conclusão" aria-expanded="false">
                                &#9432;
                                <span class="info-icone-tooltip">Taxa de conclusão = porcentagem de hábitos do dia que foram marcados como concluídos.</span>
                            </button>
                        </span>
                    </div>
                </article>
            </section>

            <section class="secao-grafico">
                <h2 class="secao-titulo">Progresso Semanal</h2>
                <div class="grafico-container">
                    <div class="grafico-barras" id="graficoSemanal">
                    </div>
                    <div class="grafico-legenda">
                        <span>Seg</span>
                        <span>Ter</span>
                        <span>Qua</span>
                        <span>Qui</span>
                        <span>Sex</span>
                        <span>Sáb</span>
                        <span>Dom</span>
                    </div>
                </div>
                <p class="grafico-descricao">
                    Este gráfico mostra a porcentagem de hábitos concluídos em cada dia da semana atual.
                </p>
            </section>

            <section class="secao-habitos-recentes">
                <h2 class="secao-titulo">Hábitos de Hoje</h2>
                <div class="lista-habitos-hoje" id="habitosHoje">
                </div>
            </section>
        </main>

        <button class="fab" id="btnNovoHabito" aria-label="Adicionar novo hábito">
            <span>+</span>
        </button>
    </div>

    <!-- MODAL: SELEÇÃO DE TIPO DE HÁBITO -->
    <div class="modal-backdrop" id="modalTipoBackdrop">
        <div class="modal modal-pequeno" role="dialog" aria-labelledby="tituloModalTipo" aria-modal="true">
            <div class="modal-header">
                <h2 id="tituloModalTipo">Escolha o Tipo de Hábito</h2>
                <button type="button" class="btn-fechar-modal" id="btnFecharModalTipo" aria-label="Fechar modal">
                    &times;
                </button>
            </div>
            <div class="modal-body">
                <p class="modal-descricao">Selecione como você deseja acompanhar este hábito:</p>
                <div class="tipo-habito-opcoes">
                    <button type="button" class="tipo-habito-btn" data-tipo="binario">
                        <span class="tipo-icone">&#10003;</span>
                        <span class="tipo-nome">Sim ou Não</span>
                        <span class="tipo-descricao">Ideal para hábitos que você simplesmente faz ou não faz. Ex: Meditar, Tomar vitamina, Acordar cedo.</span>
                    </button>
                    <button type="button" class="tipo-habito-btn" data-tipo="mensuravel">
                        <span class="tipo-icone">&#9776;</span>
                        <span class="tipo-nome">Mensurável</span>
                        <span class="tipo-descricao">Para hábitos com quantidade. Ex: Beber 2L de água, Ler 30 páginas, Caminhar 5km.</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL: FORMULÁRIO PRINCIPAL DE HÁBITO -->
    <div class="modal-backdrop" id="modalHabitoBackdrop">
        <div class="modal modal-habito modal-habito-avancado" role="dialog" aria-labelledby="tituloModalHabito" aria-modal="true">
            <div class="modal-header">
                <h2 id="tituloModalHabito">Novo Hábito</h2>
                <button type="button" class="btn-fechar-modal" id="btnFecharModalHabito" aria-label="Fechar modal">
                    &times;
                </button>
            </div>
            <div class="modal-body">
                <form class="form-habito form-habito-avancado" id="formHabito">
                    <input type="hidden" id="habitoId" value="">
                    <input type="hidden" id="tipoHabitoHidden" value="binario">

                    <div class="form-secao tipo-indicador-secao" id="tipoIndicadorSecao">
                        <div class="tipo-indicador" id="tipoIndicador">
                            <span class="tipo-indicador-icone">&#10003;</span>
                            <span class="tipo-indicador-texto">Hábito Sim/Não</span>
                        </div>
                    </div>

                    <div class="form-secao">
                        <div class="campo-grupo">
                            <label for="nomeHabito">Nome do hábito</label>
                            <input 
                                type="text" 
                                id="nomeHabito" 
                                name="nomeHabito" 
                                placeholder="Ex: Beber água, Meditar, Ler..." 
                                required
                            >
                        </div>
                    </div>

                    <div class="form-secao campos-mensuravel" id="camposMensuravel" style="display: none;">
                        <h3 class="form-secao-titulo">Meta Diária</h3>
                        <div class="campos-linha">
                            <div class="campo-grupo campo-pequeno">
                                <label for="alvoDiario">Alvo</label>
                                <input type="number" id="alvoDiario" name="alvoDiario" min="1" value="1">
                            </div>
                            <div class="campo-grupo campo-medio">
                                <label for="unidadeHabito">Unidade</label>
                                <input type="text" id="unidadeHabito" name="unidadeHabito" placeholder="Ex: litros, páginas">
                            </div>
                        </div>
                    </div>

                    <div class="form-secao">
                        <h3 class="form-secao-titulo">Frequência</h3>
                        <div class="campo-grupo">
                            <select id="tipoFrequencia" name="tipoFrequencia" required>
                                <option value="diario">Todos os dias</option>
                                <option value="x-semana">X vezes por semana</option>
                                <option value="x-mes">X vezes por mês</option>
                                <option value="x-em-y">Personalizado...</option>
                            </select>
                        </div>
                        
                        <div class="campos-frequencia-dinamica" id="camposFrequenciaDinamica">
                            <div class="campos-linha campos-x-semana" id="camposXSemana" style="display: none;">
                                <div class="campo-grupo campo-pequeno">
                                    <label for="vezesXSemana">Vezes</label>
                                    <input type="number" id="vezesXSemana" min="1" max="7" value="3">
                                </div>
                                <span class="campo-complemento">vezes por semana</span>
                            </div>
                            
                            <div class="campos-linha campos-x-mes" id="camposXMes" style="display: none;">
                                <div class="campo-grupo campo-pequeno">
                                    <label for="vezesXMes">Vezes</label>
                                    <input type="number" id="vezesXMes" min="1" max="31" value="10">
                                </div>
                                <span class="campo-complemento">vezes por mês</span>
                            </div>
                            
                            <div class="frequencia-personalizada-info" id="frequenciaPersonalizadaInfo" style="display: none;">
                                <span class="frequencia-personalizada-texto" id="frequenciaPersonalizadaTexto">3 vezes em 5 dias</span>
                                <button type="button" class="btn-texto" id="btnEditarFrequenciaXY">Alterar</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-secao">
                        <h3 class="form-secao-titulo">Lembretes</h3>
                        
                        <div class="lembrete-toggle-container">
                            <label class="toggle-switch">
                                <input type="checkbox" id="lembreteAtivo" name="lembreteAtivo">
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="toggle-label" id="lembreteLabel">Desabilitado</span>
                        </div>

                        <div class="lembrete-config" id="lembreteConfig" style="display: none;">
                            <div class="campo-grupo">
                                <label for="horaLembrete">Horário do lembrete</label>
                                <input type="time" id="horaLembrete" name="horaLembrete" value="08:00">
                            </div>
                            
                            <div class="dias-semana-container">
                                <div class="dias-semana-header">
                                    <span>Dias da semana</span>
                                    <button type="button" class="btn-texto" id="btnToggleDias">Selecionar todos</button>
                                </div>
                                <div class="dias-semana-grid" id="diasSemanaGrid">
                                    <button type="button" class="dia-semana-btn" data-dia="dom">Dom</button>
                                    <button type="button" class="dia-semana-btn" data-dia="seg">Seg</button>
                                    <button type="button" class="dia-semana-btn" data-dia="ter">Ter</button>
                                    <button type="button" class="dia-semana-btn" data-dia="qua">Qua</button>
                                    <button type="button" class="dia-semana-btn" data-dia="qui">Qui</button>
                                    <button type="button" class="dia-semana-btn" data-dia="sex">Sex</button>
                                    <button type="button" class="dia-semana-btn" data-dia="sab">Sáb</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-secao">
                        <h3 class="form-secao-titulo">Cor</h3>
                        <div class="cores-grid" id="coresGrid">
                            <label class="cor-opcao">
                                <input type="radio" name="corHabito" value="#10b981" checked>
                                <span class="cor-preview" style="background-color: #10b981"></span>
                            </label>
                            <label class="cor-opcao">
                                <input type="radio" name="corHabito" value="#f59e0b">
                                <span class="cor-preview" style="background-color: #f59e0b"></span>
                            </label>
                            <label class="cor-opcao">
                                <input type="radio" name="corHabito" value="#6366f1">
                                <span class="cor-preview" style="background-color: #6366f1"></span>
                            </label>
                            <label class="cor-opcao">
                                <input type="radio" name="corHabito" value="#8b5cf6">
                                <span class="cor-preview" style="background-color: #8b5cf6"></span>
                            </label>
                            <label class="cor-opcao">
                                <input type="radio" name="corHabito" value="#3b82f6">
                                <span class="cor-preview" style="background-color: #3b82f6"></span>
                            </label>
                            <label class="cor-opcao">
                                <input type="radio" name="corHabito" value="#ec4899">
                                <span class="cor-preview" style="background-color: #ec4899"></span>
                            </label>
                            <label class="cor-opcao">
                                <input type="radio" name="corHabito" value="#14b8a6">
                                <span class="cor-preview" style="background-color: #14b8a6"></span>
                            </label>
                            <label class="cor-opcao">
                                <input type="radio" name="corHabito" value="#ef4444">
                                <span class="cor-preview" style="background-color: #ef4444"></span>
                            </label>
                        </div>
                    </div>

                    <div class="form-acoes">
                        <button type="button" class="btn-secundario" id="btnCancelarHabito">Cancelar</button>
                        <button type="submit" class="btn-primario" id="btnSalvarHabito">Salvar Hábito</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MODAL: VALOR PARA HÁBITO MENSURÁVEL -->
    <div class="modal-backdrop" id="modalValorBackdrop">
        <div class="modal modal-pequeno" role="dialog" aria-labelledby="tituloModalValor" aria-modal="true">
            <div class="modal-header">
                <h2 id="tituloModalValor">Registrar Valor</h2>
                <button type="button" class="btn-fechar-modal" id="btnFecharModalValor" aria-label="Fechar modal">
                    &times;
                </button>
            </div>
            <div class="modal-body">
                <p class="modal-pergunta" id="perguntaValor">Quanto você completou hoje?</p>
                <div class="campo-valor-modal">
                    <input type="number" id="inputValorDia" min="0" step="0.5" value="0" class="input-valor-grande">
                    <span class="valor-unidade" id="valorUnidade">unidades</span>
                </div>
                <div class="valor-progresso-preview">
                    <span id="valorProgressoTexto">0/0</span>
                    <div class="progresso-barra-mensuravel">
                        <div class="progresso-barra-preenchido" id="valorProgressoBarra" style="width: 0%"></div>
                    </div>
                </div>
                <div class="form-acoes">
                    <button type="button" class="btn-secundario" id="btnCancelarValor">Cancelar</button>
                    <button type="button" class="btn-primario" id="btnConfirmarValor">Confirmar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL: FREQUÊNCIA PERSONALIZADA -->
    <div class="modal-backdrop" id="modalFrequenciaXYBackdrop">
        <div class="modal modal-pequeno" role="dialog" aria-labelledby="tituloModalFrequenciaXY" aria-modal="true">
            <div class="modal-header">
                <h2 id="tituloModalFrequenciaXY">Frequência Personalizada</h2>
                <button type="button" class="btn-fechar-modal" id="btnFecharModalFrequenciaXY" aria-label="Fechar modal">
                    &times;
                </button>
            </div>
            <div class="modal-body">
                <p class="modal-descricao">Defina quantas vezes você quer completar este hábito:</p>
                <div class="frequencia-xy-container">
                    <input type="number" id="inputVezesX" min="1" value="3" class="input-frequencia">
                    <span class="frequencia-texto">vezes em</span>
                    <input type="number" id="inputDiasY" min="1" value="5" class="input-frequencia">
                    <span class="frequencia-texto">dias</span>
                </div>
                <p class="frequencia-exemplo" id="frequenciaExemplo">Exemplo: Completar 3 vezes a cada 5 dias</p>
                <div class="form-acoes">
                    <button type="button" class="btn-secundario" id="btnCancelarFrequenciaXY">Cancelar</button>
                    <button type="button" class="btn-primario" id="btnConfirmarFrequenciaXY">Confirmar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="toast-container" id="toastContainer" role="status" aria-live="polite" aria-atomic="true"></div>

    <!-- MODAL: PREFERÊNCIAS -->
    <div class="modal-backdrop" id="modalPreferenciasBackdrop">
        <div class="modal modal-pequeno" role="dialog" aria-labelledby="tituloModalPreferencias" aria-modal="true">
            <div class="modal-header">
                <h2 id="tituloModalPreferencias">Preferências</h2>
                <button type="button" class="btn-fechar-modal" id="btnFecharPreferencias" aria-label="Fechar modal">
                    &times;
                </button>
            </div>
            <div class="modal-body">
                <h3 class="modal-secao-titulo">Tema</h3>
                <div class="toggle-container">
                    <div class="toggle-label">
                        <span class="toggle-label-icon">&#127769;</span>
                        <span>Modo escuro</span>
                    </div>
                    <div class="toggle-switch" id="toggleModoEscuro" role="switch" aria-checked="false" tabindex="0">
                        <div class="toggle-switch-slider"></div>
                    </div>
                </div>
                <p class="modal-descricao">O tema será aplicado automaticamente em todas as páginas.</p>
            </div>
        </div>
    </div>

    <!-- MODAL: ESTATÍSTICAS DO HÁBITO -->
    <div class="modal-backdrop" id="modalStatsBackdrop">
        <div class="modal modal-medio" role="dialog" aria-labelledby="tituloModalStats" aria-modal="true">
            <div class="modal-header">
                <h2 id="tituloModalStats">Estatísticas: <span id="statsHabitoNome">Hábito</span></h2>
                <button type="button" class="btn-fechar-modal" id="btnFecharStats" aria-label="Fechar modal">
                    &times;
                </button>
            </div>
            <div class="modal-body">
                <div class="stats-grid">
                    <div class="stats-item">
                        <div class="stats-item-valor" id="statsDiasConcluidos">0</div>
                        <div class="stats-item-label">Dias Concluídos</div>
                    </div>
                    <div class="stats-item">
                        <div class="stats-item-valor" id="statsStreakMaxima">0</div>
                        <div class="stats-item-label">Maior Sequência</div>
                    </div>
                </div>
                
                <div class="stats-secao-titulo">
                    Tipo de hábito
                    <span class="stats-tipo-badge" id="statsTipoBadge">Sim/Não</span>
                </div>
                
                <div class="stats-secao" id="statsSecaoMensuravel" style="display: none;">
                    <h4 class="stats-secao-titulo">&#128200; Estatísticas de Valores</h4>
                    <div class="stats-grid">
                        <div class="stats-item">
                            <div class="stats-item-valor" id="statsMedia">0</div>
                            <div class="stats-item-label">Média</div>
                        </div>
                        <div class="stats-item">
                            <div class="stats-item-valor" id="statsMaximo">0</div>
                            <div class="stats-item-label">Máximo</div>
                        </div>
                        <div class="stats-item">
                            <div class="stats-item-valor" id="statsMinimo">0</div>
                            <div class="stats-item-label">Mínimo</div>
                        </div>
                    </div>
                </div>
                
                <div class="form-acoes">
                    <button type="button" class="btn-primario" id="btnFecharModalStats">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/main.js"></script>
</body>
</html>
